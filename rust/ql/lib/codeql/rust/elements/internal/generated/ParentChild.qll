// generated by codegen, do not edit
/**
 * This module provides the generated parent/child relationship.
 */

import codeql.rust.elements

private module Impl {
  private Element getImmediateChildOfElement(Element e, int index, string partialPredicateCall) {
    none()
  }

  private Element getImmediateChildOfLocatable(Locatable e, int index, string partialPredicateCall) {
    exists(int b, int bElement, int n |
      b = 0 and
      bElement = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfElement(e, i, _)) | i) and
      n = bElement and
      (
        none()
        or
        result = getImmediateChildOfElement(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfUnextracted(
    Unextracted e, int index, string partialPredicateCall
  ) {
    exists(int b, int bElement, int n |
      b = 0 and
      bElement = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfElement(e, i, _)) | i) and
      n = bElement and
      (
        none()
        or
        result = getImmediateChildOfElement(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfAstNode(AstNode e, int index, string partialPredicateCall) {
    exists(int b, int bLocatable, int n |
      b = 0 and
      bLocatable = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfLocatable(e, i, _)) | i) and
      n = bLocatable and
      (
        none()
        or
        result = getImmediateChildOfLocatable(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfMissing(Missing e, int index, string partialPredicateCall) {
    exists(int b, int bUnextracted, int n |
      b = 0 and
      bUnextracted =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfUnextracted(e, i, _)) | i) and
      n = bUnextracted and
      (
        none()
        or
        result = getImmediateChildOfUnextracted(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfUnimplemented(
    Unimplemented e, int index, string partialPredicateCall
  ) {
    exists(int b, int bUnextracted, int n |
      b = 0 and
      bUnextracted =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfUnextracted(e, i, _)) | i) and
      n = bUnextracted and
      (
        none()
        or
        result = getImmediateChildOfUnextracted(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfAbi(Abi e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfArgList(ArgList e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nArg |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nArg = n + 1 + max(int i | i = -1 or exists(e.getArg(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getArg(index - n) and
        partialPredicateCall = "Arg(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfAssocItem(AssocItem e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfAssocItemList(
    AssocItemList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nAssocItem, int nAttr |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAssocItem = n + 1 + max(int i | i = -1 or exists(e.getAssocItem(i)) | i) and
      nAttr = nAssocItem + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAssocItem(index - n) and
        partialPredicateCall = "AssocItem(" + (index - n).toString() + ")"
        or
        result = e.getAttr(index - nAssocItem) and
        partialPredicateCall = "Attr(" + (index - nAssocItem).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfAttr(Attr e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nMeta |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nMeta = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getMeta() and partialPredicateCall = "Meta()"
      )
    )
  }

  private Element getImmediateChildOfClosureBinder(
    ClosureBinder e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nGenericParamList |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nGenericParamList = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
      )
    )
  }

  private Element getImmediateChildOfExpr(Expr e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfExternItem(ExternItem e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfExternItemList(
    ExternItemList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nAttr, int nExternItem |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExternItem = nAttr + 1 + max(int i | i = -1 or exists(e.getExternItem(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        result = e.getExternItem(index - nAttr) and
        partialPredicateCall = "ExternItem(" + (index - nAttr).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfFieldList(FieldList e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfFormatArgsArg(
    FormatArgsArg e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nExpr, int nName |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nExpr = n + 1 and
      nName = nExpr + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getName() and partialPredicateCall = "Name()"
      )
    )
  }

  private Element getImmediateChildOfGenericArg(GenericArg e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfGenericArgList(
    GenericArgList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nGenericArg |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nGenericArg = n + 1 + max(int i | i = -1 or exists(e.getGenericArg(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getGenericArg(index - n) and
        partialPredicateCall = "GenericArg(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfGenericParam(
    GenericParam e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfGenericParamList(
    GenericParamList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nGenericParam |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nGenericParam = n + 1 + max(int i | i = -1 or exists(e.getGenericParam(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getGenericParam(index - n) and
        partialPredicateCall = "GenericParam(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfItemList(ItemList e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nAttr, int nItem |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nItem = nAttr + 1 + max(int i | i = -1 or exists(e.getItem(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        result = e.getItem(index - nAttr) and
        partialPredicateCall = "Item(" + (index - nAttr).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfLabel(Label e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nLifetime |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nLifetime = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getLifetime() and partialPredicateCall = "Lifetime()"
      )
    )
  }

  private Element getImmediateChildOfLetElse(LetElse e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nBlockExpr |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nBlockExpr = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getBlockExpr() and partialPredicateCall = "BlockExpr()"
      )
    )
  }

  private Element getImmediateChildOfLifetime(Lifetime e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfMatchArm(MatchArm e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nAttr, int nExpr, int nGuard, int nPat |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      nGuard = nExpr + 1 and
      nPat = nGuard + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getGuard() and partialPredicateCall = "Guard()"
        or
        index = nGuard and result = e.getPat() and partialPredicateCall = "Pat()"
      )
    )
  }

  private Element getImmediateChildOfMatchArmList(
    MatchArmList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nArm, int nAttr |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nArm = n + 1 + max(int i | i = -1 or exists(e.getArm(i)) | i) and
      nAttr = nArm + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getArm(index - n) and
        partialPredicateCall = "Arm(" + (index - n).toString() + ")"
        or
        result = e.getAttr(index - nArm) and
        partialPredicateCall = "Attr(" + (index - nArm).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfMatchGuard(MatchGuard e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nCondition |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nCondition = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getCondition() and partialPredicateCall = "Condition()"
      )
    )
  }

  private Element getImmediateChildOfMeta(Meta e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nExpr, int nPath, int nTokenTree |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nExpr = n + 1 and
      nPath = nExpr + 1 and
      nTokenTree = nPath + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getPath() and partialPredicateCall = "Path()"
        or
        index = nPath and result = e.getTokenTree() and partialPredicateCall = "TokenTree()"
      )
    )
  }

  private Element getImmediateChildOfName(Name e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfNameRef(NameRef e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfParam(Param e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nAttr, int nPat, int nTy |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nPat = nAttr + 1 and
      nTy = nPat + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getPat() and partialPredicateCall = "Pat()"
        or
        index = nPat and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfParamList(ParamList e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nParam, int nSelfParam |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nParam = n + 1 + max(int i | i = -1 or exists(e.getParam(i)) | i) and
      nSelfParam = nParam + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getParam(index - n) and
        partialPredicateCall = "Param(" + (index - n).toString() + ")"
        or
        index = nParam and result = e.getSelfParam() and partialPredicateCall = "SelfParam()"
      )
    )
  }

  private Element getImmediateChildOfPat(Pat e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfPath(Path e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nQualifier, int nPart |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nQualifier = n + 1 and
      nPart = nQualifier + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getQualifier() and partialPredicateCall = "Qualifier()"
        or
        index = nQualifier and result = e.getPart() and partialPredicateCall = "Part()"
      )
    )
  }

  private Element getImmediateChildOfPathSegment(
    PathSegment e, int index, string partialPredicateCall
  ) {
    exists(
      int b, int bAstNode, int n, int nGenericArgList, int nNameRef, int nParamList, int nPathType,
      int nRetType, int nReturnTypeSyntax, int nTy
    |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nGenericArgList = n + 1 and
      nNameRef = nGenericArgList + 1 and
      nParamList = nNameRef + 1 and
      nPathType = nParamList + 1 and
      nRetType = nPathType + 1 and
      nReturnTypeSyntax = nRetType + 1 and
      nTy = nReturnTypeSyntax + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getGenericArgList() and partialPredicateCall = "GenericArgList()"
        or
        index = nGenericArgList and result = e.getNameRef() and partialPredicateCall = "NameRef()"
        or
        index = nNameRef and result = e.getParamList() and partialPredicateCall = "ParamList()"
        or
        index = nParamList and result = e.getPathType() and partialPredicateCall = "PathType()"
        or
        index = nPathType and result = e.getRetType() and partialPredicateCall = "RetType()"
        or
        index = nRetType and
        result = e.getReturnTypeSyntax() and
        partialPredicateCall = "ReturnTypeSyntax()"
        or
        index = nReturnTypeSyntax and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfRecordExprField(
    RecordExprField e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nAttr, int nExpr, int nNameRef |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      nNameRef = nExpr + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getNameRef() and partialPredicateCall = "NameRef()"
      )
    )
  }

  private Element getImmediateChildOfRecordExprFieldList(
    RecordExprFieldList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nAttr, int nField, int nSpread |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nField = nAttr + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      nSpread = nField + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        result = e.getField(index - nAttr) and
        partialPredicateCall = "Field(" + (index - nAttr).toString() + ")"
        or
        index = nField and result = e.getSpread() and partialPredicateCall = "Spread()"
      )
    )
  }

  private Element getImmediateChildOfRecordField(
    RecordField e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nAttr, int nName, int nTy, int nVisibility |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nName = nAttr + 1 and
      nTy = nName + 1 and
      nVisibility = nTy + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTy() and partialPredicateCall = "Ty()"
        or
        index = nTy and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfRecordPatField(
    RecordPatField e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nAttr, int nNameRef, int nPat |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nNameRef = nAttr + 1 and
      nPat = nNameRef + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getNameRef() and partialPredicateCall = "NameRef()"
        or
        index = nNameRef and result = e.getPat() and partialPredicateCall = "Pat()"
      )
    )
  }

  private Element getImmediateChildOfRecordPatFieldList(
    RecordPatFieldList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nField, int nRestPat |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nField = n + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      nRestPat = nField + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getField(index - n) and
        partialPredicateCall = "Field(" + (index - n).toString() + ")"
        or
        index = nField and result = e.getRestPat() and partialPredicateCall = "RestPat()"
      )
    )
  }

  private Element getImmediateChildOfRename(Rename e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nName |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nName = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getName() and partialPredicateCall = "Name()"
      )
    )
  }

  private Element getImmediateChildOfRetType(RetType e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nTy |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nTy = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfReturnTypeSyntax(
    ReturnTypeSyntax e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfSelfParam(SelfParam e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nAttr, int nLifetime, int nName, int nTy |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nLifetime = nAttr + 1 and
      nName = nLifetime + 1 and
      nTy = nName + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getLifetime() and partialPredicateCall = "Lifetime()"
        or
        index = nLifetime and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfSourceFile(SourceFile e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nAttr, int nItem |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nItem = nAttr + 1 + max(int i | i = -1 or exists(e.getItem(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        result = e.getItem(index - nAttr) and
        partialPredicateCall = "Item(" + (index - nAttr).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfStmt(Stmt e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfStmtList(StmtList e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nAttr, int nStatement, int nTailExpr |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nStatement = nAttr + 1 + max(int i | i = -1 or exists(e.getStatement(i)) | i) and
      nTailExpr = nStatement + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        result = e.getStatement(index - nAttr) and
        partialPredicateCall = "Statement(" + (index - nAttr).toString() + ")"
        or
        index = nStatement and result = e.getTailExpr() and partialPredicateCall = "TailExpr()"
      )
    )
  }

  private Element getImmediateChildOfToken(Token e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfTokenTree(TokenTree e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfTupleField(TupleField e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nAttr, int nTy, int nVisibility |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nTy = nAttr + 1 and
      nVisibility = nTy + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getTy() and partialPredicateCall = "Ty()"
        or
        index = nTy and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfTypeBound(TypeBound e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nGenericParamList, int nLifetime, int nTy |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nGenericParamList = n + 1 and
      nLifetime = nGenericParamList + 1 and
      nTy = nLifetime + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and
        result = e.getLifetime() and
        partialPredicateCall = "Lifetime()"
        or
        index = nLifetime and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfTypeBoundList(
    TypeBoundList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nBound |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nBound = n + 1 + max(int i | i = -1 or exists(e.getBound(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getBound(index - n) and
        partialPredicateCall = "Bound(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfTypeRef(TypeRef e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfUseTree(UseTree e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nPath, int nRename, int nUseTreeList |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nPath = n + 1 and
      nRename = nPath + 1 and
      nUseTreeList = nRename + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPath() and partialPredicateCall = "Path()"
        or
        index = nPath and result = e.getRename() and partialPredicateCall = "Rename()"
        or
        index = nRename and result = e.getUseTreeList() and partialPredicateCall = "UseTreeList()"
      )
    )
  }

  private Element getImmediateChildOfUseTreeList(
    UseTreeList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nUseTree |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nUseTree = n + 1 + max(int i | i = -1 or exists(e.getUseTree(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getUseTree(index - n) and
        partialPredicateCall = "UseTree(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfVariant(Variant e, int index, string partialPredicateCall) {
    exists(
      int b, int bAstNode, int n, int nAttr, int nExpr, int nFieldList, int nName, int nVisibility
    |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      nFieldList = nExpr + 1 and
      nName = nFieldList + 1 and
      nVisibility = nName + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getFieldList() and partialPredicateCall = "FieldList()"
        or
        index = nFieldList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfVariantList(
    VariantList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nVariant |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nVariant = n + 1 + max(int i | i = -1 or exists(e.getVariant(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getVariant(index - n) and
        partialPredicateCall = "Variant(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfVisibility(Visibility e, int index, string partialPredicateCall) {
    exists(int b, int bAstNode, int n, int nPath |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nPath = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPath() and partialPredicateCall = "Path()"
      )
    )
  }

  private Element getImmediateChildOfWhereClause(
    WhereClause e, int index, string partialPredicateCall
  ) {
    exists(int b, int bAstNode, int n, int nPredicate |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nPredicate = n + 1 + max(int i | i = -1 or exists(e.getPredicate(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        result = e.getPredicate(index - n) and
        partialPredicateCall = "Predicate(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfWherePred(WherePred e, int index, string partialPredicateCall) {
    exists(
      int b, int bAstNode, int n, int nGenericParamList, int nLifetime, int nTy, int nTypeBoundList
    |
      b = 0 and
      bAstNode = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAstNode(e, i, _)) | i) and
      n = bAstNode and
      nGenericParamList = n + 1 and
      nLifetime = nGenericParamList + 1 and
      nTy = nLifetime + 1 and
      nTypeBoundList = nTy + 1 and
      (
        none()
        or
        result = getImmediateChildOfAstNode(e, index - b, partialPredicateCall)
        or
        index = n and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and
        result = e.getLifetime() and
        partialPredicateCall = "Lifetime()"
        or
        index = nLifetime and result = e.getTy() and partialPredicateCall = "Ty()"
        or
        index = nTy and result = e.getTypeBoundList() and partialPredicateCall = "TypeBoundList()"
      )
    )
  }

  private Element getImmediateChildOfArrayExpr(ArrayExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 + max(int i | i = -1 or exists(e.getExpr(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        result = e.getExpr(index - nAttr) and
        partialPredicateCall = "Expr(" + (index - nAttr).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfArrayType(ArrayType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nConstArg, int nTy |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nConstArg = n + 1 and
      nTy = nConstArg + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getConstArg() and partialPredicateCall = "ConstArg()"
        or
        index = nConstArg and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfAsmExpr(AsmExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfAssocTypeArg(
    AssocTypeArg e, int index, string partialPredicateCall
  ) {
    exists(
      int b, int bGenericArg, int n, int nConstArg, int nGenericArgList, int nNameRef,
      int nParamList, int nRetType, int nReturnTypeSyntax, int nTy, int nTypeBoundList
    |
      b = 0 and
      bGenericArg =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfGenericArg(e, i, _)) | i) and
      n = bGenericArg and
      nConstArg = n + 1 and
      nGenericArgList = nConstArg + 1 and
      nNameRef = nGenericArgList + 1 and
      nParamList = nNameRef + 1 and
      nRetType = nParamList + 1 and
      nReturnTypeSyntax = nRetType + 1 and
      nTy = nReturnTypeSyntax + 1 and
      nTypeBoundList = nTy + 1 and
      (
        none()
        or
        result = getImmediateChildOfGenericArg(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getConstArg() and partialPredicateCall = "ConstArg()"
        or
        index = nConstArg and
        result = e.getGenericArgList() and
        partialPredicateCall = "GenericArgList()"
        or
        index = nGenericArgList and result = e.getNameRef() and partialPredicateCall = "NameRef()"
        or
        index = nNameRef and result = e.getParamList() and partialPredicateCall = "ParamList()"
        or
        index = nParamList and result = e.getRetType() and partialPredicateCall = "RetType()"
        or
        index = nRetType and
        result = e.getReturnTypeSyntax() and
        partialPredicateCall = "ReturnTypeSyntax()"
        or
        index = nReturnTypeSyntax and result = e.getTy() and partialPredicateCall = "Ty()"
        or
        index = nTy and result = e.getTypeBoundList() and partialPredicateCall = "TypeBoundList()"
      )
    )
  }

  private Element getImmediateChildOfAwaitExpr(AwaitExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfBecomeExpr(BecomeExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfBinaryExpr(BinaryExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nLhs, int nRhs |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nLhs = nAttr + 1 and
      nRhs = nLhs + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getLhs() and partialPredicateCall = "Lhs()"
        or
        index = nLhs and result = e.getRhs() and partialPredicateCall = "Rhs()"
      )
    )
  }

  private Element getImmediateChildOfBlockExpr(BlockExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nLabel, int nStmtList |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nLabel = nAttr + 1 and
      nStmtList = nLabel + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getLabel() and partialPredicateCall = "Label()"
        or
        index = nLabel and result = e.getStmtList() and partialPredicateCall = "StmtList()"
      )
    )
  }

  private Element getImmediateChildOfBoxPat(BoxPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nPat |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nPat = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPat() and partialPredicateCall = "Pat()"
      )
    )
  }

  private Element getImmediateChildOfBreakExpr(BreakExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr, int nLifetime |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      nLifetime = nExpr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getLifetime() and partialPredicateCall = "Lifetime()"
      )
    )
  }

  private Element getImmediateChildOfCallExpr(CallExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nArgList, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nArgList = n + 1 and
      nAttr = nArgList + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getArgList() and partialPredicateCall = "ArgList()"
        or
        result = e.getAttr(index - nArgList) and
        partialPredicateCall = "Attr(" + (index - nArgList).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfCastExpr(CastExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr, int nTy |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      nTy = nExpr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfClosureExpr(
    ClosureExpr e, int index, string partialPredicateCall
  ) {
    exists(
      int b, int bExpr, int n, int nAttr, int nBody, int nClosureBinder, int nParamList,
      int nRetType
    |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nBody = nAttr + 1 and
      nClosureBinder = nBody + 1 and
      nParamList = nClosureBinder + 1 and
      nRetType = nParamList + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getBody() and partialPredicateCall = "Body()"
        or
        index = nBody and result = e.getClosureBinder() and partialPredicateCall = "ClosureBinder()"
        or
        index = nClosureBinder and
        result = e.getParamList() and
        partialPredicateCall = "ParamList()"
        or
        index = nParamList and result = e.getRetType() and partialPredicateCall = "RetType()"
      )
    )
  }

  private Element getImmediateChildOfComment(Comment e, int index, string partialPredicateCall) {
    exists(int b, int bToken, int n |
      b = 0 and
      bToken = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfToken(e, i, _)) | i) and
      n = bToken and
      (
        none()
        or
        result = getImmediateChildOfToken(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfConstArg(ConstArg e, int index, string partialPredicateCall) {
    exists(int b, int bGenericArg, int n, int nExpr |
      b = 0 and
      bGenericArg =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfGenericArg(e, i, _)) | i) and
      n = bGenericArg and
      nExpr = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfGenericArg(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfConstBlockPat(
    ConstBlockPat e, int index, string partialPredicateCall
  ) {
    exists(int b, int bPat, int n, int nBlockExpr |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nBlockExpr = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getBlockExpr() and partialPredicateCall = "BlockExpr()"
      )
    )
  }

  private Element getImmediateChildOfConstParam(ConstParam e, int index, string partialPredicateCall) {
    exists(int b, int bGenericParam, int n, int nAttr, int nDefaultVal, int nName, int nTy |
      b = 0 and
      bGenericParam =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfGenericParam(e, i, _)) | i) and
      n = bGenericParam and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nDefaultVal = nAttr + 1 and
      nName = nDefaultVal + 1 and
      nTy = nName + 1 and
      (
        none()
        or
        result = getImmediateChildOfGenericParam(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getDefaultVal() and partialPredicateCall = "DefaultVal()"
        or
        index = nDefaultVal and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfContinueExpr(
    ContinueExpr e, int index, string partialPredicateCall
  ) {
    exists(int b, int bExpr, int n, int nAttr, int nLifetime |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nLifetime = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getLifetime() and partialPredicateCall = "Lifetime()"
      )
    )
  }

  private Element getImmediateChildOfDynTraitType(
    DynTraitType e, int index, string partialPredicateCall
  ) {
    exists(int b, int bTypeRef, int n, int nTypeBoundList |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nTypeBoundList = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getTypeBoundList() and partialPredicateCall = "TypeBoundList()"
      )
    )
  }

  private Element getImmediateChildOfExprStmt(ExprStmt e, int index, string partialPredicateCall) {
    exists(int b, int bStmt, int n, int nExpr |
      b = 0 and
      bStmt = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfStmt(e, i, _)) | i) and
      n = bStmt and
      nExpr = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfStmt(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfFieldExpr(FieldExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr, int nNameRef |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      nNameRef = nExpr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getNameRef() and partialPredicateCall = "NameRef()"
      )
    )
  }

  private Element getImmediateChildOfFnPtrType(FnPtrType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nAbi, int nParamList, int nRetType |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nAbi = n + 1 and
      nParamList = nAbi + 1 and
      nRetType = nParamList + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getAbi() and partialPredicateCall = "Abi()"
        or
        index = nAbi and result = e.getParamList() and partialPredicateCall = "ParamList()"
        or
        index = nParamList and result = e.getRetType() and partialPredicateCall = "RetType()"
      )
    )
  }

  private Element getImmediateChildOfForExpr(ForExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nIterable, int nLabel, int nLoopBody, int nPat |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nIterable = nAttr + 1 and
      nLabel = nIterable + 1 and
      nLoopBody = nLabel + 1 and
      nPat = nLoopBody + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getIterable() and partialPredicateCall = "Iterable()"
        or
        index = nIterable and result = e.getLabel() and partialPredicateCall = "Label()"
        or
        index = nLabel and result = e.getLoopBody() and partialPredicateCall = "LoopBody()"
        or
        index = nLoopBody and result = e.getPat() and partialPredicateCall = "Pat()"
      )
    )
  }

  private Element getImmediateChildOfForType(ForType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nGenericParamList, int nTy |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nGenericParamList = n + 1 and
      nTy = nGenericParamList + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfFormatArgsExpr(
    FormatArgsExpr e, int index, string partialPredicateCall
  ) {
    exists(int b, int bExpr, int n, int nArg, int nAttr, int nTemplate |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nArg = n + 1 + max(int i | i = -1 or exists(e.getArg(i)) | i) and
      nAttr = nArg + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nTemplate = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getArg(index - n) and
        partialPredicateCall = "Arg(" + (index - n).toString() + ")"
        or
        result = e.getAttr(index - nArg) and
        partialPredicateCall = "Attr(" + (index - nArg).toString() + ")"
        or
        index = nAttr and result = e.getTemplate() and partialPredicateCall = "Template()"
      )
    )
  }

  private Element getImmediateChildOfIdentPat(IdentPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nAttr, int nName, int nPat |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nName = nAttr + 1 and
      nPat = nName + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getPat() and partialPredicateCall = "Pat()"
      )
    )
  }

  private Element getImmediateChildOfIfExpr(IfExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nCondition, int nElse, int nThen |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nCondition = nAttr + 1 and
      nElse = nCondition + 1 and
      nThen = nElse + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getCondition() and partialPredicateCall = "Condition()"
        or
        index = nCondition and result = e.getElse() and partialPredicateCall = "Else()"
        or
        index = nElse and result = e.getThen() and partialPredicateCall = "Then()"
      )
    )
  }

  private Element getImmediateChildOfImplTraitType(
    ImplTraitType e, int index, string partialPredicateCall
  ) {
    exists(int b, int bTypeRef, int n, int nTypeBoundList |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nTypeBoundList = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getTypeBoundList() and partialPredicateCall = "TypeBoundList()"
      )
    )
  }

  private Element getImmediateChildOfIndexExpr(IndexExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nBase, int nIndex |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nBase = nAttr + 1 and
      nIndex = nBase + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getBase() and partialPredicateCall = "Base()"
        or
        index = nBase and result = e.getIndex() and partialPredicateCall = "Index()"
      )
    )
  }

  private Element getImmediateChildOfInferType(InferType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfItem(Item e, int index, string partialPredicateCall) {
    exists(int b, int bStmt, int n |
      b = 0 and
      bStmt = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfStmt(e, i, _)) | i) and
      n = bStmt and
      (
        none()
        or
        result = getImmediateChildOfStmt(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfLetExpr(LetExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr, int nPat |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      nPat = nExpr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getPat() and partialPredicateCall = "Pat()"
      )
    )
  }

  private Element getImmediateChildOfLetStmt(LetStmt e, int index, string partialPredicateCall) {
    exists(int b, int bStmt, int n, int nAttr, int nInitializer, int nLetElse, int nPat, int nTy |
      b = 0 and
      bStmt = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfStmt(e, i, _)) | i) and
      n = bStmt and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nInitializer = nAttr + 1 and
      nLetElse = nInitializer + 1 and
      nPat = nLetElse + 1 and
      nTy = nPat + 1 and
      (
        none()
        or
        result = getImmediateChildOfStmt(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getInitializer() and partialPredicateCall = "Initializer()"
        or
        index = nInitializer and result = e.getLetElse() and partialPredicateCall = "LetElse()"
        or
        index = nLetElse and result = e.getPat() and partialPredicateCall = "Pat()"
        or
        index = nPat and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfLifetimeArg(
    LifetimeArg e, int index, string partialPredicateCall
  ) {
    exists(int b, int bGenericArg, int n, int nLifetime |
      b = 0 and
      bGenericArg =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfGenericArg(e, i, _)) | i) and
      n = bGenericArg and
      nLifetime = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfGenericArg(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getLifetime() and partialPredicateCall = "Lifetime()"
      )
    )
  }

  private Element getImmediateChildOfLifetimeParam(
    LifetimeParam e, int index, string partialPredicateCall
  ) {
    exists(int b, int bGenericParam, int n, int nAttr, int nLifetime, int nTypeBoundList |
      b = 0 and
      bGenericParam =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfGenericParam(e, i, _)) | i) and
      n = bGenericParam and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nLifetime = nAttr + 1 and
      nTypeBoundList = nLifetime + 1 and
      (
        none()
        or
        result = getImmediateChildOfGenericParam(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getLifetime() and partialPredicateCall = "Lifetime()"
        or
        index = nLifetime and
        result = e.getTypeBoundList() and
        partialPredicateCall = "TypeBoundList()"
      )
    )
  }

  private Element getImmediateChildOfLiteralExpr(
    LiteralExpr e, int index, string partialPredicateCall
  ) {
    exists(int b, int bExpr, int n, int nAttr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfLiteralPat(LiteralPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nLiteral |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nLiteral = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getLiteral() and partialPredicateCall = "Literal()"
      )
    )
  }

  private Element getImmediateChildOfLoopExpr(LoopExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nLabel, int nLoopBody |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nLabel = nAttr + 1 and
      nLoopBody = nLabel + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getLabel() and partialPredicateCall = "Label()"
        or
        index = nLabel and result = e.getLoopBody() and partialPredicateCall = "LoopBody()"
      )
    )
  }

  private Element getImmediateChildOfMacroExpr(MacroExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nMacroCall |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nMacroCall = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getMacroCall() and partialPredicateCall = "MacroCall()"
      )
    )
  }

  private Element getImmediateChildOfMacroPat(MacroPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nMacroCall |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nMacroCall = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getMacroCall() and partialPredicateCall = "MacroCall()"
      )
    )
  }

  private Element getImmediateChildOfMacroType(MacroType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nMacroCall |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nMacroCall = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getMacroCall() and partialPredicateCall = "MacroCall()"
      )
    )
  }

  private Element getImmediateChildOfMatchExpr(MatchExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr, int nMatchArmList |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      nMatchArmList = nExpr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
        or
        index = nExpr and result = e.getMatchArmList() and partialPredicateCall = "MatchArmList()"
      )
    )
  }

  private Element getImmediateChildOfMethodCallExpr(
    MethodCallExpr e, int index, string partialPredicateCall
  ) {
    exists(
      int b, int bExpr, int n, int nArgList, int nAttr, int nGenericArgList, int nNameRef,
      int nReceiver
    |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nArgList = n + 1 and
      nAttr = nArgList + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nGenericArgList = nAttr + 1 and
      nNameRef = nGenericArgList + 1 and
      nReceiver = nNameRef + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getArgList() and partialPredicateCall = "ArgList()"
        or
        result = e.getAttr(index - nArgList) and
        partialPredicateCall = "Attr(" + (index - nArgList).toString() + ")"
        or
        index = nAttr and
        result = e.getGenericArgList() and
        partialPredicateCall = "GenericArgList()"
        or
        index = nGenericArgList and result = e.getNameRef() and partialPredicateCall = "NameRef()"
        or
        index = nNameRef and result = e.getReceiver() and partialPredicateCall = "Receiver()"
      )
    )
  }

  private Element getImmediateChildOfNeverType(NeverType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfOffsetOfExpr(
    OffsetOfExpr e, int index, string partialPredicateCall
  ) {
    exists(int b, int bExpr, int n, int nAttr, int nField, int nTy |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nField = nAttr + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      nTy = nField + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        result = e.getField(index - nAttr) and
        partialPredicateCall = "Field(" + (index - nAttr).toString() + ")"
        or
        index = nField and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfOrPat(OrPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nPat |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nPat = n + 1 + max(int i | i = -1 or exists(e.getPat(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        result = e.getPat(index - n) and
        partialPredicateCall = "Pat(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfParenExpr(ParenExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfParenPat(ParenPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nPat |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nPat = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPat() and partialPredicateCall = "Pat()"
      )
    )
  }

  private Element getImmediateChildOfParenType(ParenType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nTy |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nTy = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfPathExpr(PathExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nPath |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nPath = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getPath() and partialPredicateCall = "Path()"
      )
    )
  }

  private Element getImmediateChildOfPathPat(PathPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nPath |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nPath = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPath() and partialPredicateCall = "Path()"
      )
    )
  }

  private Element getImmediateChildOfPathType(PathType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nPath |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nPath = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPath() and partialPredicateCall = "Path()"
      )
    )
  }

  private Element getImmediateChildOfPrefixExpr(PrefixExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfPtrType(PtrType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nTy |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nTy = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfRangeExpr(RangeExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nEnd, int nStart |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nEnd = nAttr + 1 and
      nStart = nEnd + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getEnd() and partialPredicateCall = "End()"
        or
        index = nEnd and result = e.getStart() and partialPredicateCall = "Start()"
      )
    )
  }

  private Element getImmediateChildOfRangePat(RangePat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nEnd, int nStart |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nEnd = n + 1 and
      nStart = nEnd + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getEnd() and partialPredicateCall = "End()"
        or
        index = nEnd and result = e.getStart() and partialPredicateCall = "Start()"
      )
    )
  }

  private Element getImmediateChildOfRecordExpr(RecordExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nPath, int nRecordExprFieldList |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nPath = n + 1 and
      nRecordExprFieldList = nPath + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPath() and partialPredicateCall = "Path()"
        or
        index = nPath and
        result = e.getRecordExprFieldList() and
        partialPredicateCall = "RecordExprFieldList()"
      )
    )
  }

  private Element getImmediateChildOfRecordFieldList(
    RecordFieldList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bFieldList, int n, int nField |
      b = 0 and
      bFieldList = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfFieldList(e, i, _)) | i) and
      n = bFieldList and
      nField = n + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfFieldList(e, index - b, partialPredicateCall)
        or
        result = e.getField(index - n) and
        partialPredicateCall = "Field(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfRecordPat(RecordPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nPath, int nRecordPatFieldList |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nPath = n + 1 and
      nRecordPatFieldList = nPath + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPath() and partialPredicateCall = "Path()"
        or
        index = nPath and
        result = e.getRecordPatFieldList() and
        partialPredicateCall = "RecordPatFieldList()"
      )
    )
  }

  private Element getImmediateChildOfRefExpr(RefExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfRefPat(RefPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nPat |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nPat = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getPat() and partialPredicateCall = "Pat()"
      )
    )
  }

  private Element getImmediateChildOfRefType(RefType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nLifetime, int nTy |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nLifetime = n + 1 and
      nTy = nLifetime + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getLifetime() and partialPredicateCall = "Lifetime()"
        or
        index = nLifetime and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfRestPat(RestPat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nAttr |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfReturnExpr(ReturnExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfSlicePat(SlicePat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nPat |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nPat = n + 1 + max(int i | i = -1 or exists(e.getPat(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        result = e.getPat(index - n) and
        partialPredicateCall = "Pat(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfSliceType(SliceType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nTy |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nTy = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfTryExpr(TryExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfTupleExpr(TupleExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nField |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nField = nAttr + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        result = e.getField(index - nAttr) and
        partialPredicateCall = "Field(" + (index - nAttr).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfTupleFieldList(
    TupleFieldList e, int index, string partialPredicateCall
  ) {
    exists(int b, int bFieldList, int n, int nField |
      b = 0 and
      bFieldList = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfFieldList(e, i, _)) | i) and
      n = bFieldList and
      nField = n + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfFieldList(e, index - b, partialPredicateCall)
        or
        result = e.getField(index - n) and
        partialPredicateCall = "Field(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfTuplePat(TuplePat e, int index, string partialPredicateCall) {
    exists(int b, int bPat, int n, int nField |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nField = n + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        result = e.getField(index - n) and
        partialPredicateCall = "Field(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfTupleStructPat(
    TupleStructPat e, int index, string partialPredicateCall
  ) {
    exists(int b, int bPat, int n, int nField, int nPath |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      nField = n + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      nPath = nField + 1 and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
        or
        result = e.getField(index - n) and
        partialPredicateCall = "Field(" + (index - n).toString() + ")"
        or
        index = nField and result = e.getPath() and partialPredicateCall = "Path()"
      )
    )
  }

  private Element getImmediateChildOfTupleType(TupleType e, int index, string partialPredicateCall) {
    exists(int b, int bTypeRef, int n, int nField |
      b = 0 and
      bTypeRef = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfTypeRef(e, i, _)) | i) and
      n = bTypeRef and
      nField = n + 1 + max(int i | i = -1 or exists(e.getField(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfTypeRef(e, index - b, partialPredicateCall)
        or
        result = e.getField(index - n) and
        partialPredicateCall = "Field(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfTypeArg(TypeArg e, int index, string partialPredicateCall) {
    exists(int b, int bGenericArg, int n, int nTy |
      b = 0 and
      bGenericArg =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfGenericArg(e, i, _)) | i) and
      n = bGenericArg and
      nTy = n + 1 and
      (
        none()
        or
        result = getImmediateChildOfGenericArg(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getTy() and partialPredicateCall = "Ty()"
      )
    )
  }

  private Element getImmediateChildOfTypeParam(TypeParam e, int index, string partialPredicateCall) {
    exists(
      int b, int bGenericParam, int n, int nAttr, int nDefaultType, int nName, int nTypeBoundList
    |
      b = 0 and
      bGenericParam =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfGenericParam(e, i, _)) | i) and
      n = bGenericParam and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nDefaultType = nAttr + 1 and
      nName = nDefaultType + 1 and
      nTypeBoundList = nName + 1 and
      (
        none()
        or
        result = getImmediateChildOfGenericParam(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getDefaultType() and partialPredicateCall = "DefaultType()"
        or
        index = nDefaultType and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTypeBoundList() and partialPredicateCall = "TypeBoundList()"
      )
    )
  }

  private Element getImmediateChildOfUnderscoreExpr(
    UnderscoreExpr e, int index, string partialPredicateCall
  ) {
    exists(int b, int bExpr, int n, int nAttr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
      )
    )
  }

  private Element getImmediateChildOfWhileExpr(WhileExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nCondition, int nLabel, int nLoopBody |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nCondition = nAttr + 1 and
      nLabel = nCondition + 1 and
      nLoopBody = nLabel + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getCondition() and partialPredicateCall = "Condition()"
        or
        index = nCondition and result = e.getLabel() and partialPredicateCall = "Label()"
        or
        index = nLabel and result = e.getLoopBody() and partialPredicateCall = "LoopBody()"
      )
    )
  }

  private Element getImmediateChildOfWildcardPat(
    WildcardPat e, int index, string partialPredicateCall
  ) {
    exists(int b, int bPat, int n |
      b = 0 and
      bPat = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfPat(e, i, _)) | i) and
      n = bPat and
      (
        none()
        or
        result = getImmediateChildOfPat(e, index - b, partialPredicateCall)
      )
    )
  }

  private Element getImmediateChildOfYeetExpr(YeetExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfYieldExpr(YieldExpr e, int index, string partialPredicateCall) {
    exists(int b, int bExpr, int n, int nAttr, int nExpr |
      b = 0 and
      bExpr = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExpr(e, i, _)) | i) and
      n = bExpr and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExpr = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfExpr(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getExpr() and partialPredicateCall = "Expr()"
      )
    )
  }

  private Element getImmediateChildOfConst(Const e, int index, string partialPredicateCall) {
    exists(
      int b, int bAssocItem, int bItem, int n, int nAttr, int nBody, int nName, int nTy,
      int nVisibility
    |
      b = 0 and
      bAssocItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAssocItem(e, i, _)) | i) and
      bItem = bAssocItem + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nBody = nAttr + 1 and
      nName = nBody + 1 and
      nTy = nName + 1 and
      nVisibility = nTy + 1 and
      (
        none()
        or
        result = getImmediateChildOfAssocItem(e, index - b, partialPredicateCall)
        or
        result = getImmediateChildOfItem(e, index - bAssocItem, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getBody() and partialPredicateCall = "Body()"
        or
        index = nBody and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTy() and partialPredicateCall = "Ty()"
        or
        index = nTy and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfEnum(Enum e, int index, string partialPredicateCall) {
    exists(
      int b, int bItem, int n, int nAttr, int nGenericParamList, int nName, int nVariantList,
      int nVisibility, int nWhereClause
    |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nGenericParamList = nAttr + 1 and
      nName = nGenericParamList + 1 and
      nVariantList = nName + 1 and
      nVisibility = nVariantList + 1 and
      nWhereClause = nVisibility + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getVariantList() and partialPredicateCall = "VariantList()"
        or
        index = nVariantList and
        result = e.getVisibility() and
        partialPredicateCall = "Visibility()"
        or
        index = nVisibility and
        result = e.getWhereClause() and
        partialPredicateCall = "WhereClause()"
      )
    )
  }

  private Element getImmediateChildOfExternBlock(
    ExternBlock e, int index, string partialPredicateCall
  ) {
    exists(int b, int bItem, int n, int nAbi, int nAttr, int nExternItemList |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAbi = n + 1 and
      nAttr = nAbi + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nExternItemList = nAttr + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getAbi() and partialPredicateCall = "Abi()"
        or
        result = e.getAttr(index - nAbi) and
        partialPredicateCall = "Attr(" + (index - nAbi).toString() + ")"
        or
        index = nAttr and
        result = e.getExternItemList() and
        partialPredicateCall = "ExternItemList()"
      )
    )
  }

  private Element getImmediateChildOfExternCrate(
    ExternCrate e, int index, string partialPredicateCall
  ) {
    exists(int b, int bItem, int n, int nAttr, int nNameRef, int nRename, int nVisibility |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nNameRef = nAttr + 1 and
      nRename = nNameRef + 1 and
      nVisibility = nRename + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getNameRef() and partialPredicateCall = "NameRef()"
        or
        index = nNameRef and result = e.getRename() and partialPredicateCall = "Rename()"
        or
        index = nRename and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfFunction(Function e, int index, string partialPredicateCall) {
    exists(
      int b, int bAssocItem, int bExternItem, int bItem, int n, int nAbi, int nAttr, int nBody,
      int nGenericParamList, int nName, int nParamList, int nRetType, int nVisibility,
      int nWhereClause
    |
      b = 0 and
      bAssocItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAssocItem(e, i, _)) | i) and
      bExternItem =
        bAssocItem + 1 + max(int i | i = -1 or exists(getImmediateChildOfExternItem(e, i, _)) | i) and
      bItem = bExternItem + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAbi = n + 1 and
      nAttr = nAbi + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nBody = nAttr + 1 and
      nGenericParamList = nBody + 1 and
      nName = nGenericParamList + 1 and
      nParamList = nName + 1 and
      nRetType = nParamList + 1 and
      nVisibility = nRetType + 1 and
      nWhereClause = nVisibility + 1 and
      (
        none()
        or
        result = getImmediateChildOfAssocItem(e, index - b, partialPredicateCall)
        or
        result = getImmediateChildOfExternItem(e, index - bAssocItem, partialPredicateCall)
        or
        result = getImmediateChildOfItem(e, index - bExternItem, partialPredicateCall)
        or
        index = n and result = e.getAbi() and partialPredicateCall = "Abi()"
        or
        result = e.getAttr(index - nAbi) and
        partialPredicateCall = "Attr(" + (index - nAbi).toString() + ")"
        or
        index = nAttr and result = e.getBody() and partialPredicateCall = "Body()"
        or
        index = nBody and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getParamList() and partialPredicateCall = "ParamList()"
        or
        index = nParamList and result = e.getRetType() and partialPredicateCall = "RetType()"
        or
        index = nRetType and result = e.getVisibility() and partialPredicateCall = "Visibility()"
        or
        index = nVisibility and
        result = e.getWhereClause() and
        partialPredicateCall = "WhereClause()"
      )
    )
  }

  private Element getImmediateChildOfImpl(Impl e, int index, string partialPredicateCall) {
    exists(
      int b, int bItem, int n, int nAssocItemList, int nAttr, int nGenericParamList, int nSelfTy,
      int nTrait, int nVisibility, int nWhereClause
    |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAssocItemList = n + 1 and
      nAttr = nAssocItemList + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nGenericParamList = nAttr + 1 and
      nSelfTy = nGenericParamList + 1 and
      nTrait = nSelfTy + 1 and
      nVisibility = nTrait + 1 and
      nWhereClause = nVisibility + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getAssocItemList() and partialPredicateCall = "AssocItemList()"
        or
        result = e.getAttr(index - nAssocItemList) and
        partialPredicateCall = "Attr(" + (index - nAssocItemList).toString() + ")"
        or
        index = nAttr and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getSelfTy() and partialPredicateCall = "SelfTy()"
        or
        index = nSelfTy and result = e.getTrait() and partialPredicateCall = "Trait()"
        or
        index = nTrait and result = e.getVisibility() and partialPredicateCall = "Visibility()"
        or
        index = nVisibility and
        result = e.getWhereClause() and
        partialPredicateCall = "WhereClause()"
      )
    )
  }

  private Element getImmediateChildOfMacroCall(MacroCall e, int index, string partialPredicateCall) {
    exists(
      int b, int bAssocItem, int bExternItem, int bItem, int n, int nAttr, int nPath, int nTokenTree
    |
      b = 0 and
      bAssocItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAssocItem(e, i, _)) | i) and
      bExternItem =
        bAssocItem + 1 + max(int i | i = -1 or exists(getImmediateChildOfExternItem(e, i, _)) | i) and
      bItem = bExternItem + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nPath = nAttr + 1 and
      nTokenTree = nPath + 1 and
      (
        none()
        or
        result = getImmediateChildOfAssocItem(e, index - b, partialPredicateCall)
        or
        result = getImmediateChildOfExternItem(e, index - bAssocItem, partialPredicateCall)
        or
        result = getImmediateChildOfItem(e, index - bExternItem, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getPath() and partialPredicateCall = "Path()"
        or
        index = nPath and result = e.getTokenTree() and partialPredicateCall = "TokenTree()"
      )
    )
  }

  private Element getImmediateChildOfMacroDef(MacroDef e, int index, string partialPredicateCall) {
    exists(int b, int bItem, int n, int nArgs, int nAttr, int nBody, int nName, int nVisibility |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nArgs = n + 1 and
      nAttr = nArgs + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nBody = nAttr + 1 and
      nName = nBody + 1 and
      nVisibility = nName + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getArgs() and partialPredicateCall = "Args()"
        or
        result = e.getAttr(index - nArgs) and
        partialPredicateCall = "Attr(" + (index - nArgs).toString() + ")"
        or
        index = nAttr and result = e.getBody() and partialPredicateCall = "Body()"
        or
        index = nBody and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfMacroRules(MacroRules e, int index, string partialPredicateCall) {
    exists(int b, int bItem, int n, int nAttr, int nName, int nTokenTree, int nVisibility |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nName = nAttr + 1 and
      nTokenTree = nName + 1 and
      nVisibility = nTokenTree + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTokenTree() and partialPredicateCall = "TokenTree()"
        or
        index = nTokenTree and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfModule(Module e, int index, string partialPredicateCall) {
    exists(int b, int bItem, int n, int nAttr, int nItemList, int nName, int nVisibility |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nItemList = nAttr + 1 and
      nName = nItemList + 1 and
      nVisibility = nName + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getItemList() and partialPredicateCall = "ItemList()"
        or
        index = nItemList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfStatic(Static e, int index, string partialPredicateCall) {
    exists(
      int b, int bExternItem, int bItem, int n, int nAttr, int nBody, int nName, int nTy,
      int nVisibility
    |
      b = 0 and
      bExternItem =
        b + 1 + max(int i | i = -1 or exists(getImmediateChildOfExternItem(e, i, _)) | i) and
      bItem = bExternItem + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nBody = nAttr + 1 and
      nName = nBody + 1 and
      nTy = nName + 1 and
      nVisibility = nTy + 1 and
      (
        none()
        or
        result = getImmediateChildOfExternItem(e, index - b, partialPredicateCall)
        or
        result = getImmediateChildOfItem(e, index - bExternItem, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getBody() and partialPredicateCall = "Body()"
        or
        index = nBody and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTy() and partialPredicateCall = "Ty()"
        or
        index = nTy and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  private Element getImmediateChildOfStruct(Struct e, int index, string partialPredicateCall) {
    exists(
      int b, int bItem, int n, int nAttr, int nFieldList, int nGenericParamList, int nName,
      int nVisibility, int nWhereClause
    |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nFieldList = nAttr + 1 and
      nGenericParamList = nFieldList + 1 and
      nName = nGenericParamList + 1 and
      nVisibility = nName + 1 and
      nWhereClause = nVisibility + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getFieldList() and partialPredicateCall = "FieldList()"
        or
        index = nFieldList and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getVisibility() and partialPredicateCall = "Visibility()"
        or
        index = nVisibility and
        result = e.getWhereClause() and
        partialPredicateCall = "WhereClause()"
      )
    )
  }

  private Element getImmediateChildOfTrait(Trait e, int index, string partialPredicateCall) {
    exists(
      int b, int bItem, int n, int nAssocItemList, int nAttr, int nGenericParamList, int nName,
      int nTypeBoundList, int nVisibility, int nWhereClause
    |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAssocItemList = n + 1 and
      nAttr = nAssocItemList + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nGenericParamList = nAttr + 1 and
      nName = nGenericParamList + 1 and
      nTypeBoundList = nName + 1 and
      nVisibility = nTypeBoundList + 1 and
      nWhereClause = nVisibility + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        index = n and result = e.getAssocItemList() and partialPredicateCall = "AssocItemList()"
        or
        result = e.getAttr(index - nAssocItemList) and
        partialPredicateCall = "Attr(" + (index - nAssocItemList).toString() + ")"
        or
        index = nAttr and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTypeBoundList() and partialPredicateCall = "TypeBoundList()"
        or
        index = nTypeBoundList and
        result = e.getVisibility() and
        partialPredicateCall = "Visibility()"
        or
        index = nVisibility and
        result = e.getWhereClause() and
        partialPredicateCall = "WhereClause()"
      )
    )
  }

  private Element getImmediateChildOfTraitAlias(TraitAlias e, int index, string partialPredicateCall) {
    exists(
      int b, int bItem, int n, int nAttr, int nGenericParamList, int nName, int nTypeBoundList,
      int nVisibility, int nWhereClause
    |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nGenericParamList = nAttr + 1 and
      nName = nGenericParamList + 1 and
      nTypeBoundList = nName + 1 and
      nVisibility = nTypeBoundList + 1 and
      nWhereClause = nVisibility + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTypeBoundList() and partialPredicateCall = "TypeBoundList()"
        or
        index = nTypeBoundList and
        result = e.getVisibility() and
        partialPredicateCall = "Visibility()"
        or
        index = nVisibility and
        result = e.getWhereClause() and
        partialPredicateCall = "WhereClause()"
      )
    )
  }

  private Element getImmediateChildOfTypeAlias(TypeAlias e, int index, string partialPredicateCall) {
    exists(
      int b, int bAssocItem, int bExternItem, int bItem, int n, int nAttr, int nGenericParamList,
      int nName, int nTy, int nTypeBoundList, int nVisibility, int nWhereClause
    |
      b = 0 and
      bAssocItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfAssocItem(e, i, _)) | i) and
      bExternItem =
        bAssocItem + 1 + max(int i | i = -1 or exists(getImmediateChildOfExternItem(e, i, _)) | i) and
      bItem = bExternItem + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nGenericParamList = nAttr + 1 and
      nName = nGenericParamList + 1 and
      nTy = nName + 1 and
      nTypeBoundList = nTy + 1 and
      nVisibility = nTypeBoundList + 1 and
      nWhereClause = nVisibility + 1 and
      (
        none()
        or
        result = getImmediateChildOfAssocItem(e, index - b, partialPredicateCall)
        or
        result = getImmediateChildOfExternItem(e, index - bAssocItem, partialPredicateCall)
        or
        result = getImmediateChildOfItem(e, index - bExternItem, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and result = e.getTy() and partialPredicateCall = "Ty()"
        or
        index = nTy and result = e.getTypeBoundList() and partialPredicateCall = "TypeBoundList()"
        or
        index = nTypeBoundList and
        result = e.getVisibility() and
        partialPredicateCall = "Visibility()"
        or
        index = nVisibility and
        result = e.getWhereClause() and
        partialPredicateCall = "WhereClause()"
      )
    )
  }

  private Element getImmediateChildOfUnion(Union e, int index, string partialPredicateCall) {
    exists(
      int b, int bItem, int n, int nAttr, int nGenericParamList, int nName, int nRecordFieldList,
      int nVisibility, int nWhereClause
    |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nGenericParamList = nAttr + 1 and
      nName = nGenericParamList + 1 and
      nRecordFieldList = nName + 1 and
      nVisibility = nRecordFieldList + 1 and
      nWhereClause = nVisibility + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and
        result = e.getGenericParamList() and
        partialPredicateCall = "GenericParamList()"
        or
        index = nGenericParamList and result = e.getName() and partialPredicateCall = "Name()"
        or
        index = nName and
        result = e.getRecordFieldList() and
        partialPredicateCall = "RecordFieldList()"
        or
        index = nRecordFieldList and
        result = e.getVisibility() and
        partialPredicateCall = "Visibility()"
        or
        index = nVisibility and
        result = e.getWhereClause() and
        partialPredicateCall = "WhereClause()"
      )
    )
  }

  private Element getImmediateChildOfUse(Use e, int index, string partialPredicateCall) {
    exists(int b, int bItem, int n, int nAttr, int nUseTree, int nVisibility |
      b = 0 and
      bItem = b + 1 + max(int i | i = -1 or exists(getImmediateChildOfItem(e, i, _)) | i) and
      n = bItem and
      nAttr = n + 1 + max(int i | i = -1 or exists(e.getAttr(i)) | i) and
      nUseTree = nAttr + 1 and
      nVisibility = nUseTree + 1 and
      (
        none()
        or
        result = getImmediateChildOfItem(e, index - b, partialPredicateCall)
        or
        result = e.getAttr(index - n) and
        partialPredicateCall = "Attr(" + (index - n).toString() + ")"
        or
        index = nAttr and result = e.getUseTree() and partialPredicateCall = "UseTree()"
        or
        index = nUseTree and result = e.getVisibility() and partialPredicateCall = "Visibility()"
      )
    )
  }

  cached
  Element getImmediateChild(Element e, int index, string partialAccessor) {
    // why does this look more complicated than it should?
    // * none() simplifies generation, as we can append `or ...` without a special case for the first item
    none()
    or
    result = getImmediateChildOfMissing(e, index, partialAccessor)
    or
    result = getImmediateChildOfUnimplemented(e, index, partialAccessor)
    or
    result = getImmediateChildOfAbi(e, index, partialAccessor)
    or
    result = getImmediateChildOfArgList(e, index, partialAccessor)
    or
    result = getImmediateChildOfAssocItemList(e, index, partialAccessor)
    or
    result = getImmediateChildOfAttr(e, index, partialAccessor)
    or
    result = getImmediateChildOfClosureBinder(e, index, partialAccessor)
    or
    result = getImmediateChildOfExternItemList(e, index, partialAccessor)
    or
    result = getImmediateChildOfFormatArgsArg(e, index, partialAccessor)
    or
    result = getImmediateChildOfGenericArgList(e, index, partialAccessor)
    or
    result = getImmediateChildOfGenericParamList(e, index, partialAccessor)
    or
    result = getImmediateChildOfItemList(e, index, partialAccessor)
    or
    result = getImmediateChildOfLabel(e, index, partialAccessor)
    or
    result = getImmediateChildOfLetElse(e, index, partialAccessor)
    or
    result = getImmediateChildOfLifetime(e, index, partialAccessor)
    or
    result = getImmediateChildOfMatchArm(e, index, partialAccessor)
    or
    result = getImmediateChildOfMatchArmList(e, index, partialAccessor)
    or
    result = getImmediateChildOfMatchGuard(e, index, partialAccessor)
    or
    result = getImmediateChildOfMeta(e, index, partialAccessor)
    or
    result = getImmediateChildOfName(e, index, partialAccessor)
    or
    result = getImmediateChildOfNameRef(e, index, partialAccessor)
    or
    result = getImmediateChildOfParam(e, index, partialAccessor)
    or
    result = getImmediateChildOfParamList(e, index, partialAccessor)
    or
    result = getImmediateChildOfPath(e, index, partialAccessor)
    or
    result = getImmediateChildOfPathSegment(e, index, partialAccessor)
    or
    result = getImmediateChildOfRecordExprField(e, index, partialAccessor)
    or
    result = getImmediateChildOfRecordExprFieldList(e, index, partialAccessor)
    or
    result = getImmediateChildOfRecordField(e, index, partialAccessor)
    or
    result = getImmediateChildOfRecordPatField(e, index, partialAccessor)
    or
    result = getImmediateChildOfRecordPatFieldList(e, index, partialAccessor)
    or
    result = getImmediateChildOfRename(e, index, partialAccessor)
    or
    result = getImmediateChildOfRetType(e, index, partialAccessor)
    or
    result = getImmediateChildOfReturnTypeSyntax(e, index, partialAccessor)
    or
    result = getImmediateChildOfSelfParam(e, index, partialAccessor)
    or
    result = getImmediateChildOfSourceFile(e, index, partialAccessor)
    or
    result = getImmediateChildOfStmtList(e, index, partialAccessor)
    or
    result = getImmediateChildOfTokenTree(e, index, partialAccessor)
    or
    result = getImmediateChildOfTupleField(e, index, partialAccessor)
    or
    result = getImmediateChildOfTypeBound(e, index, partialAccessor)
    or
    result = getImmediateChildOfTypeBoundList(e, index, partialAccessor)
    or
    result = getImmediateChildOfUseTree(e, index, partialAccessor)
    or
    result = getImmediateChildOfUseTreeList(e, index, partialAccessor)
    or
    result = getImmediateChildOfVariant(e, index, partialAccessor)
    or
    result = getImmediateChildOfVariantList(e, index, partialAccessor)
    or
    result = getImmediateChildOfVisibility(e, index, partialAccessor)
    or
    result = getImmediateChildOfWhereClause(e, index, partialAccessor)
    or
    result = getImmediateChildOfWherePred(e, index, partialAccessor)
    or
    result = getImmediateChildOfArrayExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfArrayType(e, index, partialAccessor)
    or
    result = getImmediateChildOfAsmExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfAssocTypeArg(e, index, partialAccessor)
    or
    result = getImmediateChildOfAwaitExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfBecomeExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfBinaryExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfBlockExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfBoxPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfBreakExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfCallExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfCastExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfClosureExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfComment(e, index, partialAccessor)
    or
    result = getImmediateChildOfConstArg(e, index, partialAccessor)
    or
    result = getImmediateChildOfConstBlockPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfConstParam(e, index, partialAccessor)
    or
    result = getImmediateChildOfContinueExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfDynTraitType(e, index, partialAccessor)
    or
    result = getImmediateChildOfExprStmt(e, index, partialAccessor)
    or
    result = getImmediateChildOfFieldExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfFnPtrType(e, index, partialAccessor)
    or
    result = getImmediateChildOfForExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfForType(e, index, partialAccessor)
    or
    result = getImmediateChildOfFormatArgsExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfIdentPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfIfExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfImplTraitType(e, index, partialAccessor)
    or
    result = getImmediateChildOfIndexExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfInferType(e, index, partialAccessor)
    or
    result = getImmediateChildOfLetExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfLetStmt(e, index, partialAccessor)
    or
    result = getImmediateChildOfLifetimeArg(e, index, partialAccessor)
    or
    result = getImmediateChildOfLifetimeParam(e, index, partialAccessor)
    or
    result = getImmediateChildOfLiteralExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfLiteralPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfLoopExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfMacroExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfMacroPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfMacroType(e, index, partialAccessor)
    or
    result = getImmediateChildOfMatchExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfMethodCallExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfNeverType(e, index, partialAccessor)
    or
    result = getImmediateChildOfOffsetOfExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfOrPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfParenExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfParenPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfParenType(e, index, partialAccessor)
    or
    result = getImmediateChildOfPathExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfPathPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfPathType(e, index, partialAccessor)
    or
    result = getImmediateChildOfPrefixExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfPtrType(e, index, partialAccessor)
    or
    result = getImmediateChildOfRangeExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfRangePat(e, index, partialAccessor)
    or
    result = getImmediateChildOfRecordExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfRecordFieldList(e, index, partialAccessor)
    or
    result = getImmediateChildOfRecordPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfRefExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfRefPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfRefType(e, index, partialAccessor)
    or
    result = getImmediateChildOfRestPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfReturnExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfSlicePat(e, index, partialAccessor)
    or
    result = getImmediateChildOfSliceType(e, index, partialAccessor)
    or
    result = getImmediateChildOfTryExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfTupleExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfTupleFieldList(e, index, partialAccessor)
    or
    result = getImmediateChildOfTuplePat(e, index, partialAccessor)
    or
    result = getImmediateChildOfTupleStructPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfTupleType(e, index, partialAccessor)
    or
    result = getImmediateChildOfTypeArg(e, index, partialAccessor)
    or
    result = getImmediateChildOfTypeParam(e, index, partialAccessor)
    or
    result = getImmediateChildOfUnderscoreExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfWhileExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfWildcardPat(e, index, partialAccessor)
    or
    result = getImmediateChildOfYeetExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfYieldExpr(e, index, partialAccessor)
    or
    result = getImmediateChildOfConst(e, index, partialAccessor)
    or
    result = getImmediateChildOfEnum(e, index, partialAccessor)
    or
    result = getImmediateChildOfExternBlock(e, index, partialAccessor)
    or
    result = getImmediateChildOfExternCrate(e, index, partialAccessor)
    or
    result = getImmediateChildOfFunction(e, index, partialAccessor)
    or
    result = getImmediateChildOfImpl(e, index, partialAccessor)
    or
    result = getImmediateChildOfMacroCall(e, index, partialAccessor)
    or
    result = getImmediateChildOfMacroDef(e, index, partialAccessor)
    or
    result = getImmediateChildOfMacroRules(e, index, partialAccessor)
    or
    result = getImmediateChildOfModule(e, index, partialAccessor)
    or
    result = getImmediateChildOfStatic(e, index, partialAccessor)
    or
    result = getImmediateChildOfStruct(e, index, partialAccessor)
    or
    result = getImmediateChildOfTrait(e, index, partialAccessor)
    or
    result = getImmediateChildOfTraitAlias(e, index, partialAccessor)
    or
    result = getImmediateChildOfTypeAlias(e, index, partialAccessor)
    or
    result = getImmediateChildOfUnion(e, index, partialAccessor)
    or
    result = getImmediateChildOfUse(e, index, partialAccessor)
  }
}

/**
 * Gets the "immediate" parent of `e`. "Immediate" means not taking into account node resolution: for example
 * if `e` has conversions, `getImmediateParent(e)` will give the innermost conversion in the hidden AST.
 */
Element getImmediateParent(Element e) {
  // `unique` is used here to tell the optimizer that there is in fact only one result
  // this is tested by the `library-tests/parent/no_double_parents.ql` test
  result = unique(Element x | e = Impl::getImmediateChild(x, _, _) | x)
}

/**
 * Gets the immediate child indexed at `index`. Indexes are not guaranteed to be contiguous, but are guaranteed to be distinct. `accessor` is bound the member predicate call resulting in the given child.
 */
Element getImmediateChildAndAccessor(Element e, int index, string accessor) {
  exists(string partialAccessor |
    result = Impl::getImmediateChild(e, index, partialAccessor) and
    accessor = "get" + partialAccessor
  )
}

/**
 * Gets the child indexed at `index`. Indexes are not guaranteed to be contiguous, but are guaranteed to be distinct. `accessor` is bound the member predicate call resulting in the given child.
 */
Element getChildAndAccessor(Element e, int index, string accessor) {
  exists(string partialAccessor |
    result = Impl::getImmediateChild(e, index, partialAccessor).resolve() and
    accessor = "get" + partialAccessor
  )
}
