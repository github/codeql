extensions:
  - addsTo:
      pack: codeql/rust-all
      extensible: sourceModel
    data:
      - ["main::simple_source", "ReturnValue", "test-source", "manual"]
      - ["main::enum_source", "ReturnValue.Field[main::MyFieldEnum::D::field_d]", "test-source", "manual"]
      - ["<main::MyFieldEnum>::source", "ReturnValue.Field[main::MyFieldEnum::C::field_c]", "test-source", "manual"]
      - ["main::arg_source", "Argument[0]", "test-source", "manual"]
      - ["main::source_into_function::pass_source", "Argument[1].Parameter[0]", "test-source", "manual"]
      - ["main::external_file::generated_source", "ReturnValue", "test-source", "dfc-generated"] # not actually generated, but we want to test behaviour of generated models here.
      - ["main::external_file::neutral_generated_source", "ReturnValue", "test-source", "dfc-generated"]
      - ["main::external_file::neutral_manual_source", "ReturnValue", "test-source", "manual"]
  - addsTo:
      pack: codeql/rust-all
      extensible: sinkModel
    data:
      - ["main::simple_sink", "Argument[0]", "test-sink", "manual"]
      - ["main::enum_sink", "Argument[0].Field[main::MyFieldEnum::C::field_c]", "test-sink", "manual"]
      - ["<main::MyFieldEnum>::sink", "Argument[self].Field[main::MyFieldEnum::D::field_d]", "test-sink", "manual"]
      - ["main::external_file::generated_sink", "Argument[0]", "test-sink", "dfc-generated"]
      - ["main::external_file::neutral_generated_sink", "Argument[0]", "test-sink", "dfc-generated"]
      - ["main::external_file::neutral_manual_sink", "Argument[0]", "test-sink", "manual"]
  - addsTo:
      pack: codeql/rust-all
      extensible: summaryModel
    data:
      - ["main::coerce", "Argument[0]", "ReturnValue", "taint", "manual"]
      - ["main::snd", "Argument[1]", "ReturnValue", "value", "manual"]
      # Wrong generated model which should not take effect due to the manual model above
      - ["main::snd", "Argument[0]", "ReturnValue", "value", "dfc-generated"]
      - ["main::get_var_pos", "Argument[0].Field[main::MyPosEnum::A(0)]", "ReturnValue", "value", "manual"]
      - ["main::set_var_pos", "Argument[0]", "ReturnValue.Field[main::MyPosEnum::B(0)]", "value", "manual"]
      - ["main::get_var_field", "Argument[0].Field[main::MyFieldEnum::C::field_c]", "ReturnValue", "value", "manual"]
      - ["main::set_var_field", "Argument[0]", "ReturnValue.Field[main::MyFieldEnum::D::field_d]", "value", "manual"]
      - ["main::get_struct_field", "Argument[0].Field[main::MyStruct::field1]", "ReturnValue", "value", "manual"]
      - ["main::set_struct_field", "Argument[0]", "ReturnValue.Field[main::MyStruct::field2]", "value", "manual"]
      - ["main::get_array_element", "Argument[0].Element", "ReturnValue", "value", "manual"]
      - ["main::set_array_element", "Argument[0]", "ReturnValue.Element", "value", "manual"]
      - ["main::get_tuple_element", "Argument[0].Field[0]", "ReturnValue", "value", "manual"]
      - ["main::set_tuple_element", "Argument[0]", "ReturnValue.Field[1]", "value", "manual"]
      - ["main::apply", "Argument[0]", "Argument[1].Parameter[0]", "value", "manual"]
      - ["main::apply", "Argument[1].ReturnValue", "ReturnValue", "value", "manual"]
      - ["main::get_async_number", "Argument[0]", "ReturnValue.Future", "value", "manual"]
      - ["<_ as core::cmp::PartialOrd>::lt", "Argument[self].Reference", "ReturnValue", "taint", "manual"]
      # Overwrites the generic trait model for i32
      - ["<core::i32 as core::cmp::PartialOrd>::lt", "Argument[0]", "ReturnValue", "taint", "manual"]
      - ["main::external_file::generated_summary", "Argument[0]", "ReturnValue", "value", "dfc-generated"]
      - ["main::external_file::neutral_generated_summary", "Argument[0]", "ReturnValue", "value", "dfc-generated"]
      - ["main::external_file::neutral_manual_summary", "Argument[0]", "ReturnValue", "value", "manual"]
  - addsTo:
      pack: codeql/rust-all
      extensible: neutralModel
    data:
      - ["main::external_file::neutral_generated_source", "source", "manual"]
      - ["main::external_file::neutral_manual_source", "source", "manual"]
      - ["main::external_file::neutral_generated_sink", "sink", "manual"]
      - ["main::external_file::neutral_manual_sink", "sink", "manual"]
      - ["main::external_file::neutral_generated_summary", "summary", "manual"]
      - ["main::external_file::neutral_manual_summary", "summary", "manual"]
  - addsTo:
      pack: codeql/rust-all
      extensible: additionalExternalFile
    data:
      - ["external_file.rs"]
