extensions:
  - addsTo:
      pack: codeql/java-all
      extensible: summaryModel
    data:
      - ["java.util.stream", "BaseStream", True, "iterator", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "BaseStream", True, "onClose", "(Runnable)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "BaseStream", True, "parallel", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "BaseStream", True, "sequential", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "BaseStream", True, "spliterator", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "BaseStream", True, "unordered", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "DoubleStream", True, "mapToObj", "(IntFunction)", "", "Argument[0].ReturnValue", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "IntStream", True, "mapToObj", "(IntFunction)", "", "Argument[0].ReturnValue", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "LongStream", True, "mapToObj", "(IntFunction)", "", "Argument[0].ReturnValue", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "allMatch", "(Predicate)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "anyMatch", "(Predicate)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "collect", "(Supplier,BiConsumer,BiConsumer)", "", "Argument[this].Element", "Argument[1].Parameter[1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "collect", "(Supplier,BiConsumer,BiConsumer)", "", "Argument[0].ReturnValue", "Argument[1].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "collect", "(Supplier,BiConsumer,BiConsumer)", "", "Argument[1].Parameter[0]", "Argument[2].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "collect", "(Supplier,BiConsumer,BiConsumer)", "", "Argument[1].Parameter[0]", "ReturnValue", "value", "manual"]
      - ["java.util.stream", "Stream", True, "collect", "(Supplier,BiConsumer,BiConsumer)", "", "Argument[2].Parameter[0..1]", "Argument[1].Parameter[0]", "value", "manual"]
      # collect(Collector<T,A,R> collector) is handled separately on a case-by-case basis as it is too complex for MaD
      - ["java.util.stream", "Stream", True, "concat", "(Stream,Stream)", "", "Argument[0..1].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "distinct", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "dropWhile", "(Predicate)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "dropWhile", "(Predicate)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "filter", "(Predicate)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "filter", "(Predicate)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "findAny", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "findFirst", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "flatMap", "(Function)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "flatMap", "(Function)", "", "Argument[0].ReturnValue.Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "flatMapToDouble", "(Function)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "flatMapToInt", "(Function)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "flatMapToLong", "(Function)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "forEach", "(Consumer)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "forEachOrdered", "(Consumer)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "generate", "(Supplier)", "", "Argument[0].ReturnValue", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "iterate", "(Object,Predicate,UnaryOperator)", "", "Argument[0]", "Argument[1..2].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "iterate", "(Object,Predicate,UnaryOperator)", "", "Argument[0]", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "iterate", "(Object,Predicate,UnaryOperator)", "", "Argument[2].ReturnValue", "Argument[1..2].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "iterate", "(Object,Predicate,UnaryOperator)", "", "Argument[2].ReturnValue", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "iterate", "(Object,UnaryOperator)", "", "Argument[0]", "Argument[1].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "iterate", "(Object,UnaryOperator)", "", "Argument[0]", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "iterate", "(Object,UnaryOperator)", "", "Argument[1].ReturnValue", "Argument[1].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "iterate", "(Object,UnaryOperator)", "", "Argument[1].ReturnValue", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "limit", "(long)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "map", "(Function)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "map", "(Function)", "", "Argument[0].ReturnValue", "ReturnValue.Element", "value", "manual"]
      # Missing for mapMulti(BiConsumer) (not currently supported):
      # Argument[0] of Parameter[1] of Argument[0] -> Element of Parameter[1] of Argument[0]
      # Element of Parameter[1] of Argument[0] -> Element of ReturnValue
      - ["java.util.stream", "Stream", True, "mapMulti", "(BiConsumer)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "mapMultiToDouble", "(BiConsumer)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "mapMultiToInt", "(BiConsumer)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "mapMultiToLong", "(BiConsumer)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "mapToDouble", "(ToDoubleFunction)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "mapToInt", "(ToIntFunction)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "mapToLong", "(ToLongFunction)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "max", "(Comparator)", "", "Argument[this].Element", "Argument[0].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "max", "(Comparator)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "min", "(Comparator)", "", "Argument[this].Element", "Argument[0].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "min", "(Comparator)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "noneMatch", "(Predicate)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "of", "(Object)", "", "Argument[0]", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "of", "(Object[])", "", "Argument[0].ArrayElement", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "ofNullable", "(Object)", "", "Argument[0]", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "peek", "(Consumer)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "peek", "(Consumer)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(BinaryOperator)", "", "Argument[this].Element", "Argument[0].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(BinaryOperator)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(BinaryOperator)", "", "Argument[0].ReturnValue", "Argument[0].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(BinaryOperator)", "", "Argument[0].ReturnValue", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BiFunction,BinaryOperator)", "", "Argument[this].Element", "Argument[1].Parameter[1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BiFunction,BinaryOperator)", "", "Argument[0]", "Argument[1].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BiFunction,BinaryOperator)", "", "Argument[0]", "Argument[2].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BiFunction,BinaryOperator)", "", "Argument[0]", "ReturnValue", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BiFunction,BinaryOperator)", "", "Argument[1..2].ReturnValue", "Argument[1].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BiFunction,BinaryOperator)", "", "Argument[1..2].ReturnValue", "Argument[2].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BiFunction,BinaryOperator)", "", "Argument[1..2].ReturnValue", "ReturnValue", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BinaryOperator)", "", "Argument[this].Element", "Argument[1].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BinaryOperator)", "", "Argument[0]", "Argument[1].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BinaryOperator)", "", "Argument[0]", "ReturnValue", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BinaryOperator)", "", "Argument[1].ReturnValue", "Argument[1].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "reduce", "(Object,BinaryOperator)", "", "Argument[1].ReturnValue", "ReturnValue", "value", "manual"]
      - ["java.util.stream", "Stream", True, "skip", "(long)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "sorted", "", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "sorted", "(Comparator)", "", "Argument[this].Element", "Argument[0].Parameter[0..1]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "takeWhile", "(Predicate)", "", "Argument[this].Element", "Argument[0].Parameter[0]", "value", "manual"]
      - ["java.util.stream", "Stream", True, "takeWhile", "(Predicate)", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]
      - ["java.util.stream", "Stream", True, "toArray", "", "", "Argument[this].Element", "ReturnValue.ArrayElement", "value", "manual"]
      - ["java.util.stream", "Stream", True, "toList", "()", "", "Argument[this].Element", "ReturnValue.Element", "value", "manual"]

  - addsTo:
      pack: codeql/java-all
      extensible: neutralModel
    data:
      - ["java.util.stream", "Collectors", "joining", "", "summary", "manual"] # cannot be modeled completely without a model for `java.util.stream.Stream#collect(Collector)` as well
      - ["java.util.stream", "Collectors", "toList", "()", "summary", "manual"]
      - ["java.util.stream", "Collectors", "toMap", "", "summary", "manual"] # specialized collectors flow
      - ["java.util.stream", "Collectors", "toSet", "()", "summary", "manual"]
      - ["java.util.stream", "Stream", "collect", "(Collector)", "summary", "manual"] # handled separately on a case-by-case basis as it is too complex for MaD
      - ["java.util.stream", "Stream", "count", "()", "summary", "manual"]

      # The below APIs have numeric flow and are currently being stored as neutral models.
      # These may be changed to summary models with kinds "value-numeric" and "taint-numeric" (or similar) in the future.
      - ["java.util.stream", "IntStream", "range", "(int,int)", "summary", "manual"]        # taint-numeric
